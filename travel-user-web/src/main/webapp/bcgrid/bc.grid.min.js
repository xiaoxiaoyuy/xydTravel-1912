/**
* bcgrid 1.2.1
* Created by BigQ on 2019-08-22
* Youth is just a section of unoptimized code!
*/
"use strict";window.console=window.console||function(){var e={};return e.log=e.warn=e.debug=e.info=e.error=e.time=e.dir=e.profile=e.clear=e.exception=e.trace=e.assert=function(){},e}(),function(e,t){"function"==typeof define&&define.amd?define("BCGrid",[],t):"object"==typeof module&&module.exports?module.exports=e.document?t(e):t:e.BCGrid=t(e)}("undefined"!=typeof window?window:this,function(win){var BCGrid=(d=window,e=d.document,f=d.navigator&&d.navigator.userAgent||"",h=/(edge|msie|trident)/i.test(f)&&!window.opera,j=/Firefox/.test(f),k=(m=e.currentScript?e.currentScript.src:function(){for(var t,a=e.scripts,n=a.length-1,i=n;0<i;i--)if("interactive"===a[i].readyState){t=a[i].src;break}return t||a[n].src}()).substring(0,m.lastIndexOf("/")+1),{product:"BC Grid",version:"1.2.2",doc:e,isIE:/msie/i.test(f),isMoz:/gecko/.test(f),isMS:h,isWebKit:/AppleWebKit/.test(f),isFirefox:j,win:d,path:k}),m,d,e,f,h,j,k,_jsOnloadQueue=[],langMaps={},t;t=BCGrid,t.addLang=function(e,t){langMaps[e]=t},t.getLangText=function(e,a){if(t.isEmptyObject(e)||"en"===e.toLowerCase()||t.isUnDefined(langMaps[e]))return a;var n=langMaps[e];return t.isDefined(n[a])?n[a]:a},t.create=function(e,t){return new BcGrid(e,t).render()},function(B){B.getID=function(){return Number(Math.random().toString().substr(3,4)+Date.now()).toString(36)},B.parseInt=function(e,t){return parseInt(e,t||10)},B.isString=function(e){return"string"==typeof e},B.isArray=function(e){var t=Object.prototype.toString.call(e);return"[object Array]"===t||"[object Array Iterator]"===t},B.isNumber=function(e){return"number"==typeof e&&!isNaN(e)},B.isObject=function(e,t){return!(!e||"object"!=typeof e||t&&B.isArray(e))},B.isJqueryObject=function(e){return e instanceof jQuery},B.isFunction=function(e){return e&&"function"==typeof e},B.isEmptyObject=function(t){return!B.isDefined(t)||""===t||null===t||!1===t||function(){var e;if(B.isNumber(t))return!1;for(e in t)return!1;return!0}()},B.inArray=function(e,t){for(var a=e.length;a--;)if(e[a]===t)return!0;return!1},B.isDefined=function(e){return null!=e},B.isUnDefined=function(e){return!B.isDefined(e)},B.extend=function(e,t){var a;for(a in e||(e={}),t)e[a]=t[a];return e},B.getSubArray=function(e,a,n){return B.isArray(e)?e.filter(function(e,t){return void 0!==n?e[n]===a:e===a}):[]},B.arrayToTree=function(e,t,a,n){var i=[],r={},o=0;for(o=0;o<e.length;o++)r[e[o][t]]=e[o];for(o=0;o<e.length;o++){var s=e[o],l=r[s[a]];B.isDefined(l)?(B.isDefined(l[n])||(l[n]=new Array),l[n].push(s)):i.push(s)}return i},B.arrayObjectFilter=function(e,n,i){return BCGrid.isArray(e)&&0!=e.length?BCGrid.isUnDefined(n)||!BCGrid.isArray(n)&&BCGrid.isUnDefined(i)?[]:e.filter(function(e){var t=!0;if(BCGrid.isArray(n)){for(var a in n)if(e[n[a].name]!==n[a].value){t=!1;break}}else t=e[n]===i;return t}):[]},B.arrayRemoveFilter=function(e,n,i){return BCGrid.isArray(e)&&0!=e.length?BCGrid.isUnDefined(n)||!BCGrid.isArray(n)&&BCGrid.isUnDefined(i)?[]:e.filter(function(e){var t=!0;if(BCGrid.isArray(n)){for(var a in n)if(e[n[a].name]===n[a].value){t=!1;break}}else t=e[n]!==i;return t}):[]},B.objectDeepCopy=function(e){var t=BCGrid.isArray(e)?[]:{};for(var a in e)t[a]=B.isObject(e[a])?BCGrid.objectDeepCopy(e[a]):e[a];return t},B.arraySortOnGroup=function(e,t){if(B.isEmptyObject(t)||B.isEmptyObject(e))return e;for(var a=t.length-1;0<a;a--){var n=!1;for(var i in e[0])if(t[a]==i){n=!0;break}n||t.splice(a,1)}if(B.isEmptyObject(t))return e;var r=B.objectDeepCopy(e),o="",s=[],l=0,d=0;for(a=0;a<r.length;a++){for(var c=!1,p=0;p<s.length;p++){var u=!0;for(var i in t)if(o=t[i],r[a][o]!==s[p][o]){u=!1;break}if(u){c=!0;break}}if(!c){d=0,r[a]._isroot=!0,s.push(r[a]),l=s.length-1;for(var h=0;h<r.length;h++)if(h!=a){var g=!0;for(var i in t)if(o=t[i],r[a][o]!==r[h][o]){g=!1;break}g&&(d++,r[h]._spanCount=0,r[h]._isroot=!1,s.push(r[h]))}s[l]._spanCount=d}}return s},B.getQueryString=function(e){var t=location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==t||t.length<1?"":t[1]},B.getUrlParam=function(e,t){var a=new RegExp("[?&]"+t+"=([^&]*)").exec(e);return a&&decodeURIComponent(a[1].replace(/\+/g," "))},B.setUrlParam=function(url,name,value){var r=url;if(null!=r&&"undefined"!=r&&""!=r){value=encodeURIComponent(value);var reg=new RegExp("(^|)"+name+"=([^&]*)(|$)"),tmp=name+"="+value;r=null!=url.match(reg)?url.replace(eval(reg),tmp):url.match("[?]")?url+"&"+tmp:url+"?"+tmp}return r},B.setLoadingCenterInBrowser=function(){var e=$(".bc-loading"),t=0,a=0;window.innerWidth?(a=window.innerWidth,t=window.innerHeight):"CSS1Compat"===document.compatMode?(a=document.documentElement.clientWidth,t=document.documentElement.clientHeight):(a=document.body.clientWidth,t=document.body.clientHeight);var n=(a-e.outerWidth())/2,i=(t-e.outerHeight())/2;e.css("left",n+"px"),e.css("top",i+"px")},B.showShade=function(e,t){e=this.isNumber(e)?e:.4,t=this.isNumber(t)?t:19870515;var a=$('<div class="bc-shade"></div>');a.css("z-index",t).css("opacity",e),$("body").append(a)},B.hideShade=function(){$(
".bc-shade").remove()},B.showLoading=function(e){var t={style:1,text:"Loading...",zIndex:19870515,shade:.2},a=$.extend({},t,e||{});this.showShade(a.opacity,a.zIndex-1);var n=$('<div class="bc-loading" width="180px"></div>'),i=$('<div class="bc-loading-content"></div>');3!=a.style?i.addClass("bc-loading"+a.style):(n.addClass("bc-loading-msg"),i.html('<i class="ico"></i>'+a.text)),n.css("z-index",t.zIndex),n.append(i),$("body").append(n),n.show(),$(window).on("resize",BCGrid.setLoadingCenterInBrowser),BCGrid.setLoadingCenterInBrowser()},B.hideLoading=function(){$(window).unbind("resize",this.setLoadingCenterInBrowser),$(".bc-loading").remove(),BCGrid.hideShade()},B.closeLoading=function(){BCGrid.hideLoading()},B.ajax=function(e){var n=$.extend({},{url:"",async:!0,showLoading:!0,loadingTip:"\u6570\u636e\u8bf7\u6c42\u4e2d...",loadingStyle:3,type:"post",dataType:"json",data:"",beforeSend:null,complete:null,success:null,error:null},e||{});BCGrid.isEmptyObject(n.url)&&(n.url=window.location.href),n.url=BCGrid.setUrlParam(n.url,"_tmp",(new Date).valueOf()),$.ajax({cache:!1,async:n.async,url:n.url,data:n.data,dataType:n.dataType,type:n.type,beforeSend:function(){n.showLoading&&B.showLoading({style:n.loadingStyle,text:n.loadingTip}),n.beforeSend&&n.beforeSend()},complete:function(){n.showLoading&&B.hideLoading(),n.complete&&n.complete()},success:function(e){e&&n.success&&n.success(e)},error:function(e,t,a){n.error?n.error(e,t,a):console.log(a)}})},B.loadJS=function(e,t,a){_jsOnloadQueue.push({key:t,callback:a});var n=null;B.isEmptyObject(document.getElementById(e))?((n=document.createElement("script")).setAttribute("type","text/javascript"),n.setAttribute("src",BCGrid.path+t),n.id=e,document.getElementsByTagName("head")[0].appendChild(n)):n=document.getElementById(e),"onreadystatechange"in n?n.onreadystatechange=function(){if(/loaded|complete/.test(n.readyState)){var e=B.arrayObjectFilter(_jsOnloadQueue,"key",t);if(0<e.length){for(;0<e.length;)BCGrid.isFunction(e[0].callback)&&e[0].callback(),e.shift();_jsOnloadQueue=B.arrayRemoveFilter(_jsOnloadQueue,"key",t)}}}:n.onload=function(){var e=B.arrayObjectFilter(_jsOnloadQueue,"key",t);if(0<e.length){for(;0<e.length;)BCGrid.isFunction(e[0].callback)&&e[0].callback(),e.shift();_jsOnloadQueue=B.arrayRemoveFilter(_jsOnloadQueue,"key",t)}}},B.loadCSS=function(e,t,a){if(B.isEmptyObject(document.getElementById(e))){var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=BCGrid.path+t,n.id=e,document.getElementsByTagName("head")[0].appendChild(n),"onreadystatechange"in n?n.onreadystatechange=function(){/loaded|complete/.test(n.readyState)&&BCGrid.isFunction(a)&&a()}:n.onload=function(){BCGrid.isFunction(a)&&a()}}else BCGrid.isFunction(a)&&a()},B.buildParams=function(e){var t=[];return $(e).find("input, select, textarea").not(":submit, :button,:reset, :image, [disabled]").each(function(){t.push({name:""+$(this).attr("name"),value:""+$(this).val()})}),t},B.getTableAction=function(e){var n=$('<div class="actions"></div>');return $.each(e,function(e,t){var a=$("<a></a>");if(t.type)switch(t.type){case"edit":t.color=t.color||"green",t.icon=t.icon||"fa fa-pencil";break;case"delete":t.color=t.color||"red",t.icon=t.icon||"fa fa-trash-o";break;case"conf":case"set":t.color=t.color||"grey",t.icon=t.icon||"fa fa-cog";break;case"list":case"info":case"detail":t.color=t.color||"blue",t.icon=t.icon||"fa fa-th";break;case"lock":t.color=t.color||"grey",t.icon=t.icon||"fa fa-lock";break;case"unlock":t.color=t.color||"blue",t.icon=t.icon||"fa fa-unlock"}a.addClass(t.color||""),void 0===t.type||"text"==t.type?a.html(t.title||""):a.append('<i class="'+(t.icon||"")+'"></i>'),a.attr("href",t.href||"javascript:void(0);"),t.target&&a.attr("target",t.target),n.append(a)}),n.get(0).outerHTML}}(BCGrid);var BcGrid=function(e,t){this.gridWrap=this.element=$(e),this.grid=null,this.gridHead=null,this.gridFoot=null,this.gridContent=null,this.pager=null,this.ID="",this.defaults={id:"",width:"",height:"",enableCsrf:!1,csrfName:"_csrf",lang:"en",theme:"",csrf:"",url:"",data:{},localData:[],autoLoadData:!0,showLoading:!0,loadingTip:"Loading",loadingStyle:3,enablePager:!0,page:1,pageSize:40,pageSizeOptions:[10,20,30,40,50,100],pagerAlign:"left",pagerOption:{},sortName:"",sortOrder:"",params:[],columns:[],dataSource:"server",ajaxType:"post",showCheckbox:!1,showSerialNum:!0,showBorder:!0,showStripe:!0,showHeadColor:!0,showHover:!0,showHead:!0,showTitle:!1,showFoot:!1,serialNumWidth:null,title:"",foot:"",titleAlign:null,footAlign:null,noDataHtml:'<div class="center">\u6682\u65e0\u4efb\u4f55\u8bb0\u5f55</div>',dateFormat:"yyyy-MM-dd hh:mm:ss",wrapCssClass:"",cssClass:"bc-table",rows:"rows",total:"total",pageParamName:"page",pageSizeParamName:"pagesize",sortNameParamName:"sortname",sortOrderParamName:"sortorder",pagerElement:null,enableSelectRow:!0,enableMultiSelectRow:!1,onCheckClick:null,onCheckAllClick:null,onError:null,onCompleted:null,onLoadData:null,onLoadedData:null,onSelectedRow:null,
onRowClick:null,onRowDbClick:null,onRowDetailExpandOrCollapse:null,onTreeExpandOrCollapse:null,onDataChange:null,onSelectChange:null,onSwitchChange:null,onTextFieldChange:null,onDataSave:null,toolBtns:[],rowDetail:null,rowStyle:null,tree:null,rowSpanKeys:null,colResize:{liveDrag:!0,minWidth:20}},this.options=$.extend(!0,{},this.defaults,t),this._rowIndex=0,this._showColumnLength=0,this._treeChildKey="",this.options.showTitle&&(this.options.colResize=!1),this.options.rowDetail&&(this.options.rowDetail=$.extend({},{content:function(e,t){return""},ctrlStyle:"db",align:null,expand:!1},this.options.rowDetail),this.options.tree=null,this.options.showStripe=!1,this.options.rowSpanKeys=null),this.options.tree&&(this.options.tree=$.extend({},{displayID:"",key:"id",parentKey:"parentid",expand:!1},this.options.tree),this._treeChildKey="bc_t_"+BCGrid.getID(),this.options.rowSpanKeys=null),this.options.url=BCGrid.isEmptyObject(this.options.url)?window.location.href:this.options.url};BcGrid.prototype={render:function(){var e=this,t=e.options;return t.lang&&"en"!==t.lang?BCGrid.loadJS("bc_grid_lang_"+t.lang,"lang/"+t.lang+".js",function(){_init.call(e)}):_init.call(e),this},loadData:function(e){var t=!1;0<arguments.length&&(t=e);var n=this,i=this.options,a=[];if(i.params){var r=BCGrid.isFunction(i.params)?i.params.call(n):i.params;if(BCGrid.isArray(r))$.each(r,function(){a.push({name:this.name,value:this.value})});else if(BCGrid.isObject(r))for(var o in r)a.push({name:o,value:r[o]})}var s=!0;if(i.onLoadData&&(s=i.onLoadData.call(n)||!0),0!=s)if("server"==i.dataSource)BCGrid.isEmptyObject(i.sortName)||(a.push({name:i.sortNameParamName,value:i.sortName}),a.push({name:i.sortOrderParamName,value:i.sortOrder})),i.enablePager&&(a.push({name:i.pageParamName,value:i.page}),a.push({name:i.pageSizeParamName,value:i.pageSize})),i.enableCsrf&&a.push({name:i.csrfName,value:i.csrf}),BCGrid.ajax({url:i.url,showLoading:i.showLoading,loadingTip:BCGrid.getLangText(i.lang,i.loadingTip),data:$.param(a),type:i.ajaxType,dataType:"json",success:function(e){i.data=e,_rawData=n.getData(),_displayData.call(n),t&&i.enablePager&&_displayPage.call(n),i.showCheckbox&&$("#"+n.ID+"_checkbox_all").prop("checked",!1),i.onLoadedData&&i.onLoadedData.call(n,i.data)},error:function(e,t,a){i.showLoading&&BCGrid.hideLoading(),_error.call(n,"\u6570\u636e\u52a0\u8f7d\u5931\u8d25\uff01"+a.toLocaleString())},complete:function(){}});else if("local"==i.dataSource){var l=BCGrid.objectDeepCopy(i.localData);if(!BCGrid.isEmptyObject(i.sortName)&&0<l.length&&l.sort(function(e,t){return"desc"==i.sortOrder.toLowerCase()?t[i.sortName]-e[i.sortName]:e[i.sortName]-t[i.sortName]}),0<a.length&&(l=BCGrid.arrayObjectFilter(l,a)),i.enablePager){var d=BCGrid.parseInt((i.page-1)*i.pageSize);l=l.slice(d,d+BCGrid.parseInt(i.pageSize))}i.data[i.rows]=l,i.data[i.total]=i.localData.length,_rawData=i.localData,_displayData.call(n,l),t&&i.enablePager&&_displayPage.call(n),i.showCheckbox&&$("#"+n.ID+"_checkbox_all").prop("checked",!1),i.onLoadedData&&i.onLoadedData.call(n,i.data)}},reload:function(){var e=!0,t=this;t.options.onReload&&(e=t.options.onReload.call(t)),e&&(t.options.page=1,t.loadData(!0))},reloadData:function(){var e=!0;this.options.onReload&&(e=this.options.onReload.call(this)),e&&this.loadData(!0)},refresh:function(){var e=!0;this.options.page=1,this.options.onRefresh&&(e=this.options.onRefresh.call(this)),e&&_init.call(this)},rebuild:function(e){},getCurrentPage:function(){return this.options.page},get:function(e){return this.options[e]},set:function(e){this.options=$.extend(this.options,e)},getData:function(){return BCGrid.isDefined(this.options.data[this.options.rows])?this.options.data[this.options.rows]:[]},getRawData:function(){return _rawData},getRowData:function(e){return this.options.data[this.options.rows][e]},getTotal:function(){return this.options.data[this.options.total]||0},deleteRow:function(e){var t=this.options,a=$('tr[data-rowindex="'+e+'"]',this.gridContent);t.rowDetail&&a.next('tr[data-forrowindex="'+e+'"]').remove(),0<a.length&&(a.remove(),t.data[t.total]=parseInt(t.data[t.total])-1,_displayPage.call(this))},deleteRows:function(e){var t=this,a=this.options,n=0;$.each(e,function(){var e=$('tr[data-rowindex="'+this+'"]',t.gridContent);a.rowDetail&&e.next('tr[data-forrowindex="'+this+'"]').remove(),0<e.length&&(e.remove(),n++)}),a.data[a.total]=parseInt(a.data[a.total])-n,_displayPage.call(t)},getCheckedRows:function(){var e=[],t=this.options;return t.showCheckbox&&$('input[tag="bcgrid_checkbox"]',this.gridContent).each(function(){$(this).is(":checked")&&e.push(t.data[t.rows][parseInt($(this).closest("tr").data("rowindex"))])}),e},getSelectedRows:function(){var e=[],t=this.options;return t.enableSelectRow&&$('tr[role="row"].selected',this.gridContent).each(function(){e.push(t.data[t.rows][parseInt($(this).data("rowindex"))])}),e},setCheckedRows:function(e,a){var n=this;this.options;$.each(e,function(e,t){n.setCheckedRow(t,a)})},setCheckedRow:function(e,t){
this.options;$("#"+this.ID+"_checkbox_"+e,this.gridContent).prop("checked",t)},getCheckedRowsIndex:function(){var e=[];return this.options.showCheckbox&&$('input[tag="bcgrid_checkbox"]',this.gridContent).each(function(){$(this).is(":checked")&&e.push(parseInt($(this).closest("tr").data("rowindex")))}),e},updateRow:function(e,a){var n=this,t=this.options,i=[];a?t.data[t.rows][e]=a:a=t.data[t.rows][e],i.push(n._preRenderColumn(e)),$.each(t.columns,function(e,t){i.push(n._renderColumnData(t,a,e))}),_bindEvent.call(n)},updateColumn:function(a,n){var i=this,r=this.options;n?r.columns[a]=n:n=r.columns[a],$('td[data-role="data"][data-columnindex="'+a+'"]',i.gridContent).each(function(){var e=$(this),t=e.parent("tr").data("rowindex");e.replaceWith(i._renderColumnData(n,r.data[r.rows][t],a,t))})},setTitle:function(e){this.options.title=e,$("#"+this.ID+"_title").html(e)},setFoot:function(e){this.options.foot=e,$("#"+this.ID+"_foot").html(e)},addColumn:function(e,t){var a=this.options,n=t||a.columns.length-1;a.columns.splice(n,0,e||{}),this.refresh()},toggleRowDetail:function(e){var t=this.options,a=this.getData(),n=$('tr[data-rowindex="'+e+'"]',this.gridContent),i=_toggleDetail.call(this,n);t.onRowDetailExpandOrCollapse&&BCGrid.isFunction(t.onRowDetailExpandOrCollapse)&&t.onRowDetailExpandOrCollapse.call(this,i,e,a[e])},filterData:function(e){this.options;var t=BCGrid.isObject(e)||BCGrid.isArray(e)?e:BCGrid.buildParams(e);this.set({params:t}),this.reload()}};var _localCurrentTempData=[],_rawData=[],_timeFn=null,_init=function(){_rawData=[];var e=this,t=this.options;BCGrid.isEmptyObject(t.data)&&!BCGrid.isEmptyObject(t.localData)&&(t.data[t.rows]=t.localData,t.data[t.total]=t.localData.length),BCGrid.isEmptyObject(t.id)||(e.ID=t.id),BCGrid.isEmptyObject(e.ID)&&(e.ID="bc_"+BCGrid.getID()),t.enableCsrf&&BCGrid.isEmptyObject(t.csrf)&&(t.csrf=$("input[name='"+t.csrfName+"']").val()),e.gridWrap.hasClass(t.wrapCssClass)||e.gridWrap.addClass(t.wrapCssClass);var a=BCGrid.getQueryString(t.pageParamName);isNaN(a)||""==a||(t.page=a);var n=$(".bc-table-wrap",e.gridWrap);0==n.length&&(n=$('<div class="bc-table-wrap"></div>')),e.grid=$('<table role="grid"></table>'),e.grid.attr("id",e.ID),e.grid.addClass(t.cssClass),t.showBorder&&e.grid.addClass("table-bordered"),t.showStripe&&e.grid.addClass("table-striped"),t.showHover&&e.grid.addClass("table-hover"),t.showHeadColor&&e.grid.addClass("table-head-color"),BCGrid.isEmptyObject(t.width)||n.css("width",t.width),BCGrid.isEmptyObject(t.height)||n.css("height",t.height),_preRenderColumnOpt.call(e),(t.showHead||t.showTitle)&&_setHead.call(e),t.showFoot&&_setFoot.call(e),_setGridContent.call(e),0==$("#"+e.ID,n).length?n.html(e.grid):($("#"+e.ID,n).remove(),n.prepend(e.grid)),e.gridWrap.html(n),t.onCompleted&&t.onCompleted.call(e),t.autoLoadData?e.loadData(!0):_lastHandler.call(e)},_preRenderColumnOpt=function(){var e=this,t=this.options,a={display:"",id:"",name:"name",type:"text",render:null,hide:!1,width:null,align:null,vAlign:null,headAlign:null,maxLength:null,format:null,role:"data",enableSort:!1,allowNewline:!1,elOpt:null};e._showColumnLength=t.columns.length;for(var n=0;n<t.columns.length;n++)t.columns[n]=$.extend({},a,t.columns[n]||{}),t.columns[n].hide&&e._showColumnLength--;t.showCheckbox&&e._showColumnLength++,t.showSerialNum&&e._showColumnLength++,t.rowDetail&&e._showColumnLength++},_setHead=function(){var e=this,t=this.options,a=[];if(a.push("<thead>"),t.showTitle&&(a.push('<tr role="row" class="head-title">'),a.push("<th"+(BCGrid.isDefined(t.titleAlign)?' class="'+t.titleAlign+'"':"")+' colspan="'+e._showColumnLength+'" id="'+e.ID+'_title">'+t.title+"</th>"),a.push("</tr>")),t.showHead){if(a.push('<tr role="row">'),t.rowDetail&&a.push('<th class="center col-ctrl"></th>'),t.showCheckbox&&a.push('<th class="center col-ctrl"> <label><input type="checkbox" id="'+e.ID+'_checkbox_all" tag="bcgrid_checkbox"/><span class="lbl"></span></label></th>'),t.showSerialNum){var n='class="center';BCGrid.isEmptyObject(t.serialNumWidth)?n+='"':n=isNaN(t.serialNumWidth)?n+'" width="'+t.serialNumWidth+'"':n+" width-"+t.serialNumWidth+'"',a.push("<th "+n+">"+BCGrid.getLangText(t.lang,"Serial")+"</th>")}a.push(_getHeadColumn.call(e)),a.push("</tr>")}a.push("</thead>"),e.gridHead=$(a.join("")),e.grid.html(e.gridHead)},_setFoot=function(){var e=this,t=this.options,a=[];a.push("<tfoot>"),t.showFoot&&(a.push('<tr role="row" class="footer">'),a.push("<td"+(BCGrid.isDefined(t.footAlign)?' class="'+t.footAlign+'"':"")+' colspan="'+e._showColumnLength+'" id="'+e.ID+'_foot">'+t.foot+"</td>"),a.push("</tr>")),a.push("</tfoot>"),e.gridFoot=$(a.join("")),e.grid.append(e.gridFoot)},_getHeadColumn=function(){var r=this,e=this.options,o=[];return $.each(e.columns,function(e,t){var a=t.display;BCGrid.isFunction(a)&&(a=a.call(r,t,e),BCGrid.isUnDefined(a)&&(a=""));var n=$('<th data-col="'+t.name+'" data-columnindex="'+e+'"></th>');if(BCGrid.isDefined(t.headAlign)&&n.addClass(t.headAlign),BCGrid.isEmptyObject(t.width
)||(isNaN(t.width)?n.attr("width",t.width):n.addClass("width-"+t.width)),t.hide&&n.hide(),n.html(a),t.enableSort){!n.hasClass("cursor-pointer")&&n.addClass("cursor-pointer");var i=$('<span class="sort"><i class="asc"></i><i class="desc"></i></span>');n.append(i)}o.push(n.prop("outerHTML"))}),o.join("")},_setGridContent=function(){this.gridContent=$("<tbody></tbody>"),this.grid.append(this.gridContent)},_displayData=function(e){_localCurrentTempData=[];var t=this,a=t.options;e=e||t.getData(),t.gridContent.empty(),t._rowIndex=0;var n=BCGrid.objectDeepCopy(e);a.tree?n=BCGrid.arrayToTree(n,a.tree.key,a.tree.parentKey,t._treeChildKey):BCGrid.isEmptyObject(a.rowSpanKeys)||(n=BCGrid.arraySortOnGroup(n,a.rowSpanKeys)),t.gridContent.html(_displayListData.call(t,n,0)),0==n.length?$('input:checkbox[tag="bcgrid_checkbox"]',t.gridHead).attr("disabled","disabled"):$('input:checkbox[tag="bcgrid_checkbox"]',t.gridHead).removeAttr("disabled"),_setData.call(t,_localCurrentTempData),_bindEvent.call(t)},_displayListData=function(e,d,c){var p=this,u=this.options,h=[];return BCGrid.isUnDefined(d)&&(d=0),BCGrid.isUnDefined(c)&&(c=0),c--,0==e.length&&0==d?(h.push('<tr id="'+p.ID+'_nodata" role="row" class="no_data">'),h.push('<td colspan="'+p._showColumnLength+'" class="text-center">'+u.noDataHtml+"</td>"),h.push("</tr>")):$.each(e,function(e,a){var n=!1,t=[],i="",r=!1,o="";u.rowDetail&&(o=_renderColumnDetailData.call(p,a))&&(r=!0);var s="";if(u.rowStyle){var l=_renderRowStyle.call(p,a);BCGrid.isEmptyObject(l)||(s=l)}_localCurrentTempData.push(a),u.tree&&(0<(t=BCGrid.isDefined(a[p._treeChildKey])?a[p._treeChildKey]:[]).length&&(n=!0),0<d&&(i+='data-parentrowindex="'+c+'"',u.tree.expand||(i+=' style="display:none;"'))),h.push("<tr"+s+' role="row" data-rowindex="'+p._rowIndex+'"'+i+">"),h.push(_preRenderColumn.call(p,r)),$.each(u.columns,function(e,t){h.push(_renderColumnData.call(p,t,a,e,p._rowIndex,d,n))}),h.push("</tr>"),r&&h.push(o),p._rowIndex++,u.tree&&n&&(delete _localCurrentTempData[_localCurrentTempData.length-1][p._treeChildKey],h.push(_displayListData.call(p,t,d+1,p._rowIndex)),delete a[p._treeChildKey])}),h.join("")},_preRenderColumn=function(e){var t=this,a=this.options,n=[];if(a.rowDetail){if(n.push('<td class="center" data-role="detail-ctrl">'),e){var i=a.rowDetail.expand?"row-detail-expanded":"row-detail-collapsed";if(a.rowDetail.ctrlStyle)switch(a.rowDetail.ctrlStyle){case"sg":i+="-sg";break;case"pm":i+="-pm"}n.push('<span class="row-detail-expander '+i+'"></span>')}n.push("</td>")}if(a.showCheckbox){n.push('<td class="center" data-role="checkbox"> <label class="pos-rel"><input type="checkbox" id="'+t.ID+"_checkbox_"+t._rowIndex+'" tag="bcgrid_checkbox" /><span class="lbl"></span></label></td>')}if(a.showSerialNum){var r=0;r=a.enablePager?"all"==(a.pageSize+"").toLowerCase()?t._rowIndex+1:t._rowIndex+1+(a.page-1)*a.pageSize:t._rowIndex+1,n.push('<td class="center" data-role="data">'+r+"</td>")}return n.join("")},_displayPage=function(){var a=this,n=this.options;if(!BCGrid.isEmptyObject(n.data)&&n.enablePager){var e={pageSize:n.pageSize,recordCount:n.data[n.total],pageSizeOptions:n.pageSizeOptions,currentPage:n.page,lang:n.lang,turnPageEvent:function(e,t){n.page=e,n.pageSize=t,a.loadData()}};e=$.extend(!0,n.pagerOption||{},e),BCGrid.isEmptyObject(n.pagerElement)&&(n.pagerElement=$("<div></div>"),n.pagerElement.insertAfter(a.grid)),1<n.pagerElement.length&&(e.turnPageEvent=function(e,t){n.page=e,n.pageSize=t,a.loadData(!0)}),n.pagerElement.each(function(){a.pager=new Pager($(this),e),a.pager.render()})}},_renderColumnDetailData=function(e){var t=this.options.rowDetail,a=!1;if(a=BCGrid.isFunction(t.content)?t.content.call(this,this._rowIndex,e):t.content,BCGrid.isDefined(a)&&!1!==a){a="<td"+(0==BCGrid.isEmptyObject(t.align)?' class="'+t.align+'"':"")+' colspan="'+this._showColumnLength+'">'+a+"</td>";return a='<tr role="detail" data-forrowindex="'+this._rowIndex+'"'+(0==t.expand?' style="display:none;"':"")+">"+a+"</tr>"}return!1},_renderRowStyle=function(e){var t=this.options.rowStyle,a=!1;if(a=BCGrid.isFunction(t)?t.call(this,this._rowIndex,e):t,BCGrid.isDefined(a)&&!1!==a){if(BCGrid.isString(a))return' style="'+a+'"';var n=[];return BCGrid.isDefined(a.backgroudColor)&&n.push("background-color:"+a.backgroudColor),BCGrid.isDefined(a.fontColor)&&n.push("color:"+a.fontColor),BCGrid.isDefined(a.fontSize)&&n.push("font-size:"+a.fontSize),0<n.length?' style="'+n.join(";")+'"':null}return!1},_renderColumnData=function(column,data,colIndex,rowIndex,treeDepth,hasChild){var g=this,p=this.options,opt=column,dataRes="",noPadding=!1;if(treeDepth=BCGrid.isDefined(treeDepth)?treeDepth:0,hasChild=!!BCGrid.isDefined(hasChild)&&hasChild,BCGrid.isString(opt.render)&&eval("opt.render="+opt.render),BCGrid.isFunction(opt.render))dataRes=opt.render.call(g,data,g._rowIndex),BCGrid.isObject(dataRes)&&(dataRes=BCGrid.isJqueryObject(dataRes)?dataRes[0].outerHTML:dataRes.outerHTML),BCGrid.isDefined(dataRes)||(dataRes="");else switch(opt.type){
case"grid":case"table":noPadding=!0,dataRes=_gridItem.call(g,rowIndex+0,column,data,colIndex);break;case"dateTime":case"date":dataRes=_formatDate.call(g,data[column.name],opt.format);break;case"switch":case"checkbox":noPadding=!0,dataRes=_checkboxItem.call(g,rowIndex+0,column,data,colIndex),BCGrid.isUnDefined(opt.align)&&(opt.align="center");break;case"textField":case"inputField":noPadding=!0,dataRes=_inputFieldItem.call(g,rowIndex+0,column,data,colIndex),BCGrid.isUnDefined(opt.align)&&(opt.align="center");break;case"select":noPadding=!0,dataRes=_selectItem.call(g,rowIndex+0,column,data,colIndex),BCGrid.isUnDefined(opt.align)&&(opt.align="center");break;case"serial":var serial="";serial=p.enablePager?"all"==(p.pageSize+"").toLowerCase()?g._rowIndex+1:g._rowIndex+1+(p.page-1)*p.pageSize:g._rowIndex+1,dataRes=serial;break;default:var val=BCGrid.isDefined(data[column.name])?data[column.name]+"":"";opt.maxLength&&BCGrid.isNumber(opt.maxLength)&&val.length>opt.maxLength&&(val=val.substr(0,opt.maxLength)+"..."),dataRes=_formatText.call(this,val,opt.format)}if(dataRes+="",p.tree&&p.tree.displayID===column.id&&(hasChild&&(dataRes=' <span class="tree-expander '+(p.tree.expand?"tree-expander-expanded":"tree-expander-collapsed")+'"></span>'+dataRes),0<treeDepth)){for(var treeSpace="",i=0;i<treeDepth;i++)treeSpace+='<span class="tree-indent"></span>';hasChild||(treeSpace+='<span class="tree-indent"></span>'),dataRes=treeSpace+dataRes}opt.enableEdit&&(dataRes='<span data-role="display">'+dataRes+"</span>"),dataRes='<td data-role="'+opt.role+'" data-columnindex="'+colIndex+'">'+dataRes+"</td>";var $ret=$(dataRes);if(opt.align&&$ret.addClass(opt.align),opt.vAlign&&$ret.addClass(opt.vAlign),noPadding&&$ret.addClass("none-padding"),opt.hide&&$ret.hide(),opt.allowNewline&&$ret.addClass("allow-newline"),!BCGrid.isEmptyObject(p.rowSpanKeys)&&BCGrid.inArray(p.rowSpanKeys,opt.name))if(0<data._spanCount)$ret.attr("rowspan",data._spanCount+1);else if(0==data._isroot)return"";return $ret.prop("outerHTML")},_gridItem=function(e,t,a,n){var i=this.options;if(BCGrid.isUnDefined(t.grid))return"";t.grid.dataName=t.grid.dataName||"data";var r=BCGrid.isUnDefined(a[t.grid.dataName])?[]:a[t.grid.dataName],o=$("<div></div>"),s={enableCsrf:!1,lang:i.lang,localData:r,autoLoadData:!0,showLoading:!1,loadingTip:"Loading",loadingStyle:3,enablePager:!1,columns:[],dataSource:"local",cssClass:"bc-table-sub",showCheckbox:!1,showSerialNum:!1,showBorder:!0,showStripe:!1,showHover:!1,showHead:!1,showTitle:!1,noDataHtml:i.noDataHtml,enableSelectRow:!1,enableMultiSelectRow:!1,onCheckClick:null,onCheckAllClick:null,onError:null,onCompleted:null,onLoadData:null,onLoadedData:null,onSelectedRow:null,onRowClick:null,onTreeExpandOrCollapse:null,onDataChange:null,onDataSave:null,tree:null},l=$.extend(!0,{},s,t.grid);BCGrid.create(o,l);return o.prop("outerHTML")},_checkboxItem=function(e,t,a,n){var i=this.options,r={name:t.name,onValue:1,offValue:0,onText:"ON",offText:"OFF"};r.onText=BCGrid.getLangText(i.lang,r.onText),r.offText=BCGrid.getLangText(i.lang,r.offText),BCGrid.isDefined(t.elOpt)&&(r=$.extend({},r,t.elOpt));var o=$('<label class="checkbox-switch"></label>'),s=$('<input type="checkbox"  class="column-checkbox" data-colname="'+t.name+'" data-rowindex="'+e+'" data-colindex="'+n+'" data-onvalue="'+r.onValue+'" data-offvalue="'+r.offValue+'" data-ontext="'+r.onText+'" data-offtext="'+r.offText+'" />');s.attr("name",r.name),s.attr("value",r.value);var l="<em>";return t.name&&(BCGrid.isDefined(a[t.name])?a[t.name]:"")==r.onValue?(s.attr("checked","checked"),o.addClass("checkbox-switch-on"),l+=r.onText):l+=r.offText,l+="</em>",o.append(s),o.append(l),o.append("<i></i>"),o.prop("outerHTML")},_selectItem=function(e,a,n,t){var i={name:a.name,itemsKey:"items"};BCGrid.isDefined(a.elOpt)&&(i=$.extend(!0,{},i,a.elOpt));var r=$('<select class="column-select"  data-colname="'+a.name+'" data-rowindex="'+e+'" data-colindex="'+t+'" ></select>');r.attr("name",i.name);var o=BCGrid.isDefined(n[i.itemsKey])?n[i.itemsKey]:[];return $.each(o,function(e,t){a.name&&(BCGrid.isDefined(n[a.name])?n[a.name]:"")==t.value?r.append('<option value="'+t.value+'" selected="selected">'+t.text+"</option>"):r.append('<option value="'+t.value+'">'+t.text+"</option>")}),r.prop("outerHTML")},_inputFieldItem=function(e,t,a,n){var i={name:t.name};BCGrid.isDefined(t.elOpt)&&(i=$.extend({},i,t.elOpt));var r=$('<input class="column-text" data-colname="'+t.name+'" data-rowindex="'+e+'" data-colindex="'+n+'" />');return r.attr("name",i.name),r.attr("value",BCGrid.isDefined(a[t.name])?a[t.name]:""),r.prop("outerHTML")},_formatText=function(e,t){return void 0===e&&(e=""),t?(e+="",t.replace(/\{value\}/g,e)):e},_formatDate=function(value,format){var g=this,p=g.options;function getFormat(e,t){if(isNaN(e))return"";var a=t,n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()};for(var i in/(y+)/.test(a)&&(
a=a.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return a}if(!value)return"";if("string"==typeof value&&/^\/Date/.test(value)&&(value=value.replace(/^\//,"new ").replace(/\/$/,""),eval("value = "+value)),!isNaN(value)){var newDate=new Date;newDate.setTime(1e3*value),value=newDate}if(value instanceof Date){var formatOpt=format||p.dateFormat;return getFormat(value,formatOpt)}return value.toString()},_setData=function(e){var t=this.options;t.data[t.rows]=e},_initToolBtn=function(){var t=this,e=this.options,a=[];e.refreshBtnEnable&&a.push({id:"refresh_"+t.ID,title:"\u5237\u65b0",style:"btn-primary",icon:"glyphicon-refresh",click:function(e){t.reload()}}),a.push.apply(a,e.toolBtns),t.pager.addToolButton(a)},_colResize=function(){var e=this,t=this.options;if(t.colResize&&BCGrid.isObject(t.colResize)){var a=t.colResize;!BCGrid.isEmptyObject(document.getElementById("bc_plugin_colResizable"))&&BCGrid.isFunction($.fn.colResizable)?$("#"+e.ID).colResizable(a):BCGrid.loadJS("bc_plugin_colResizable","plugin/colResizable.js",function(){$("#"+e.ID).colResizable(a)})}},_bindEvent=function(){var r=this,o=this.options,s=r.getData();$('input[type="checkbox"][tag="bcgrid_checkbox"]',r.gridHead).unbind(),$('input[type="checkbox"][tag="bcgrid_checkbox"]',r.gridHead).on("click",function(e){var t=!1;$(this).is(":checked")?(t=!0,$(":checkbox[tag='bcgrid_checkbox']",r.gridContent).prop("checked",!0)):(t=!1,$(":checkbox[tag='bcgrid_checkbox']",r.gridContent).prop("checked",!1)),o.onCheckAllClick&&BCGrid.isFunction(o.onCheckAllClick)&&o.onCheckAllClick.call(r,t)}),$("th[data-col]",r.gridHead).unbind(),$("th[data-col]",r.gridHead).on("click",function(){var e=$(this),t=parseInt(e.data("columnindex"));if(o.columns[t].enableSort){var a=$("span.sort",e),n=e.data("col")||"",i=a.attr("order")||"asc";BCGrid.isDefined(n)&&($("span.sort",r.gridHead).removeAttr("order"),"asc"==i?a.attr("order","desc"):a.attr("order","asc"),o.sortName=n,o.sortOrder=i,r.loadData())}}),$('input[type="checkbox"][tag="bcgrid_checkbox"]',r.gridContent).unbind(),$('input[type="checkbox"][tag="bcgrid_checkbox"]',r.gridContent).on("click",function(e){var t=!1,a=$(this),n=a.closest("tr");a.is(":checked")?(t=!0,n.addClass("active")):n.removeClass("active");var i=parseInt(n.data("rowindex"));o.onCheckClick&&BCGrid.isFunction(o.onCheckClick)&&o.onCheckClick.call(r,i,t,s[i]),e.stopPropagation()}),$('tr[role="row"]:not(.no_data)',r.gridContent).unbind(),$('tr[role="row"]:not(.no_data)',r.gridContent).on("click",function(a){clearTimeout(_timeFn);var e=o.onRowDbClick&&BCGrid.isFunction(o.onRowDbClick)?200:0,n=$(this);_timeFn=setTimeout(function(){if(!_isEditTarget(a.target)){var e=parseInt(n.data("rowindex"));if(o.enableSelectRow){var t=!1;n.hasClass("selected")?(t=!1,n.removeClass("selected")):(t=!0,n.addClass("selected"),0==o.enableMultiSelectRow&&n.siblings().removeClass("selected")),o.onSelectedRow&&t&&BCGrid.isFunction(o.onSelectedRow)&&o.onSelectedRow.call(r,e,s[e])}o.onRowClick&&BCGrid.isFunction(o.onRowClick)&&o.onRowClick.call(r,e,s[e])}},e)}),$('tr[role="row"]:not(.no_data)',r.gridContent).on("dblclick",function(e){if(o.onRowDbClick&&BCGrid.isFunction(o.onRowDbClick)){if(clearTimeout(_timeFn),_isEditTarget(e.target))return;var t=$(this),a=parseInt(t.data("rowindex"));o.onRowDbClick.call(r,a,s[a])}}),$("span.row-detail-expander",r.gridContent).unbind(),o.rowDetail&&$("span.row-detail-expander",r.gridContent).on("click",function(e){var t=$(this).closest("tr"),a=t.data("rowindex"),n=_toggleDetail.call(r,t);o.onRowDetailExpandOrCollapse&&BCGrid.isFunction(o.onRowDetailExpandOrCollapse)&&o.onRowDetailExpandOrCollapse.call(r,n,a,s[a])}),$("span.tree-expander",r.gridContent).unbind(),o.tree&&$("span.tree-expander",r.gridContent).on("click",function(e){var t=$(this).closest("tr"),a=t.data("rowindex"),n=_toggleTree.call(r,t);o.onTreeExpandOrCollapse&&BCGrid.isFunction(o.onTreeExpandOrCollapse)&&o.onTreeExpandOrCollapse.call(r,n,a,s[a])}),_bindDataChangeEvent.call(r),_lastHandler.call(r)},_bindDataChangeEvent=function(){var s=this,l=this.options,d=s.getData();$("input.column-text[data-rowindex],select.column-select[data-rowindex]",s.gridContent).unbind(),$("input.column-text[data-rowindex],select.column-select[data-rowindex]",s.gridContent).on("change",function(){var e=$(this),t=e.attr("name"),a=e.data("colname"),n=parseInt(e.data("rowindex")),i=parseInt(e.data("colindex")),r=e.val();d[n][a]=r;var o="";e.is("select")&&(o="selectChange",l.onSelectChange&&BCGrid.isFunction(l.onSelectChange)&&l.onSelectChange.call(s,n,t,r,d[n])),e.is("input")&&(o="textFieldChange",l.onTextFieldChange&&BCGrid.isFunction(l.onTextFieldChange)&&l.onTextFieldChange.call(s,n,t,r,d[n])),l.onDataChange&&BCGrid.isFunction(l.onDataChange)&&l.onDataChange.call(s,t,r,n,d[n],i,o)}),$("input.column-checkbox[data-rowindex]",s.gridContent).unbind(),$(
"input.column-checkbox[data-rowindex]",s.gridContent).on("click",function(){var e=$(this),t=e.attr("name"),a=e.data("colname"),n=parseInt(e.data("rowindex")),i=parseInt(e.data("colindex")),r="",o=e.parent("label.checkbox-switch");e.is(":checked")?(r=e.data("onvalue"),o.addClass("checkbox-switch-on"),$("em",o).html(e.data("ontext"))):(r=e.data("offvalue"),o.removeClass("checkbox-switch-on"),$("em",o).html(e.data("offtext"))),d[n][a]=r,l.onSwitchChange&&BCGrid.isFunction(l.onSwitchChange)&&l.onSwitchChange.call(s,n,e.is(":checked"),t,r,d[n]),l.onDataChange&&BCGrid.isFunction(l.onDataChange)&&l.onDataChange.call(s,n,t,r,d[n],i,"switchChange")})},_toggleDetail=function(e){var t=!1,a=this.options.rowDetail,n=e.data("rowindex"),i=$(".row-detail-expander",e),r="row-detail-collapsed",o="row-detail-expanded";BCGrid.isEmptyObject(a.ctrlStyle)||"sg"!==a.ctrlStyle&&"pm"!==a.ctrlStyle||(r=r+"-"+a.ctrlStyle,o=o+"-"+a.ctrlStyle),i.hasClass(r)?(i.removeClass(r).addClass(o),t=!0):(i.removeClass(o).addClass(r),t=!1);var s=e.next('tr[data-forrowindex="'+n+'"]');return t?s.show():s.hide(),t},_toggleTree=function(e){this.options;var t=!1,a=$(".tree-expander",e);return a.hasClass("tree-expander-collapsed")?(a.removeClass("tree-expander-collapsed").addClass("tree-expander-expanded"),t=!0):(a.removeClass("tree-expander-expanded").addClass("tree-expander-collapsed"),t=!1),_toggleTreeChild.call(this,e,t),t},_toggleTreeChild=function(e,n){var i=this,t=(i.options,e.data("rowindex"));e.nextAll('tr[data-parentrowindex="'+t+'"]').each(function(){var e=$(this),t=$(".tree-expander",e),a=t.hasClass("tree-expander");n?e.show():e.hide(),a&&(n?t.hasClass("tree-expander-collapsed")?_toggleTreeChild.call(i,e,!1):_toggleTreeChild.call(i,e,!0):_toggleTreeChild.call(i,e,!1))})},_error=function(e){if(!this.options.onError)throw e;this.options.onError.call(this,e)},_isEditTarget=function(e){if(!BCGrid.isDefined(e))return!1;var t=$(e);return!!t.is("span.tree-expander")||(!!t.is("label.checkbox-switch")||(!!t.is("label.checkbox-switch em")||(!!t.is("label.checkbox-switch i")||(!!t.is("span.row-detail-expander")||(!!t.is("button")||(!!t.is("input")||(!!t.is("select")||(!!t.is("textarea")||(!!t.is("a")||!!t.is("a i"))))))))))},_lastHandler=function(){_colResize.call(this)},Pager=function(e,t){this.pageWrap=this.element=$(e),this.pageCount=0,this.toolButtons=[],this.defaults={pageSize:40,recordCount:0,lang:"en",showFirst:!0,showLast:!0,showPrev:!0,showNext:!0,showWhenever:!0,showPageSizeOpt:!0,currentPage:1,pageSizeOptions:[10,20,30,40,50],firstText:"First",lastText:"Last",prevText:"Previous",nextText:"Next",turnPageEvent:null,ellipseText:"...",disabledCssClass:"disabled",ellipseCssClass:"ellipsis",firstCssClass:"first-page",lastCssClass:"last-page",prevCssClass:"prev-page",nextCssClass:"next-page",itemCssClass:"",itemCurrCssClass:"current",toolCssClass:"page-tool",infoCssClass:"page-info",linkCssClass:"page-link",optCssClass:"page-size",wrapCssClass:"bc-page",pageInfoTpl:"Page {currentPage} of {pageCount},{pageSize} records per page,total {recordCount} records",buttons:[]},this.options=$.extend({},!0,this.defaults,t)};return Pager.prototype={render:function(){return this._init(),this},_init:function(){var e=this.options;this.pageWrap.hasClass(e.wrapCssClass)||this.pageWrap.addClass(e.wrapCssClass),isNaN(e.pageSize)?this.pageCount=1:this.pageCount=Math.ceil(e.recordCount/e.pageSize),0==this.pageCount&&(this.pageCount=1),this._builder()},_builder:function(){var e=this.options;this.pageInfoWrap=$("<span> </span>"),this.pageOptWrap=$("<span> </span>"),this.pageToolWrap=$("<span></span>"),this.pageLinkWrap=$("<span></span>"),this.pageWrap.empty(),this.pageInfoWrap.addClass(e.infoCssClass),this.pageOptWrap.addClass(e.optCssClass),this.pageLinkWrap.addClass(e.linkCssClass),this.pageWrap.append(this.pageInfoWrap),this.pageWrap.append(this.pageLinkWrap),e.showPageSizeOpt&&(this.pageWrap.append(this.pageOptWrap),this._getPageOpt()),this._getPageInfo(),this._getPageContent(),this._bindEvent(),this._getPageTools()},_getPageInfo:function(){var e=this.options,t=BCGrid.getLangText(e.lang,e.pageInfoTpl).replace(/\{currentPage\}/g,e.currentPage);t=(t=(t=t.replace(/\{pageCount\}/g,this.pageCount)).replace(/\{recordCount\}/g,e.recordCount)).replace(/\{pageSize\}/g,e.pageSize),this.pageInfoWrap.html(t)},_getPageContent:function(){var e="",t=this,a=this.options;if(a.showFirst&&(e+='<a href="javascript:;" class="'+a.firstCssClass+'" >'+BCGrid.getLangText(a.lang,a.firstText)+"</a>"),a.showPrev&&(e+='<a href="javascript:;" class="'+a.prevCssClass+'">'+BCGrid.getLangText(a.lang,a.prevText)+"</a>"),6<t.pageCount){if(e+='<a href="javascript:;" data-page="1" >1</a>',a.currentPage<=2)e+='<a href="javascript:;" data-page="2">2</a>',e+='<a href="javascript:;" data-page="3">3</a></li>',e+='<span class="'+a.ellipseCssClass+'">'+a.ellipseText+"</span>";else if(2<a.currentPage&&a.currentPage<=t.pageCount-2)e+='<span class="'+a.ellipseCssClass+'">'+a.ellipseText+"</span>",
e+='<a  href="javascript:;" data-page="'+(a.currentPage-1)+'">'+(a.currentPage-1)+"</a>",e+='<a  href="javascript:;" data-page="'+a.currentPage+'">'+a.currentPage+"</a>",e+='<a  href="javascript:;" data-page="'+(a.currentPage+1)+'">'+(a.currentPage+1)+"</a>",e+='<span class="'+a.ellipseCssClass+'">'+a.ellipseText+"</span>";else{e+='<span class="'+a.ellipseCssClass+'">'+a.ellipseText+"</span>";for(var n=t.pageCount-2;n<t.pageCount;n++)e+='<a  href="javascript:;" data-page="'+n+'">'+n+"</a>"}e+='<a href="javascript:void(0);" data-page="'+t.pageCount+'">'+t.pageCount+"</a>  "}else for(n=1;n<=t.pageCount;n++)e+='<a href="javascript:;" data-page="'+n+'">'+n+"</a>";a.showNext&&(e+='<a href="javascript:;" class="'+a.nextCssClass+'" >'+BCGrid.getLangText(a.lang,a.nextText)+"</a>"),a.showLast&&(e+='<a href="javascript:;" class="'+a.lastCssClass+'" >'+BCGrid.getLangText(a.lang,a.lastText)+"</a>"),this.pageLinkWrap.html(e),1==a.currentPage&&($("."+a.firstCssClass,t.pageLinkWrap).addClass(a.disabledCssClass),$("."+a.prevCssClass,t.pageLinkWrap).addClass(a.disabledCssClass)),a.currentPage==t.pageCount&&($("."+a.lastCssClass,t.pageLinkWrap).addClass(a.disabledCssClass),$("."+a.nextCssClass,t.pageLinkWrap).addClass(a.disabledCssClass)),this.pageLinkWrap.find('a[data-page="'+a.currentPage+'"]').addClass(a.itemCurrCssClass).siblings().removeClass(a.itemCurrCssClass)},_getPageOpt:function(){var e=this,t=this.options,a=$("<select></select>"),n="";if(0<t.pageSizeOptions.length){for(var i=0;i<t.pageSizeOptions.length;i++)BCGrid.isNumber(t.pageSizeOptions[i])?n+='<option value="'+t.pageSizeOptions[i]+'">'+t.pageSizeOptions[i]+"</option>":"all"==(t.pageSizeOptions[i]+"").toLowerCase()&&(n+='<option value="all">All</option>');a.html(n),a.val(t.pageSize),this.pageOptWrap.html(""),this.pageOptWrap.append(BCGrid.getLangText(t.lang,"Per page")),this.pageOptWrap.append(a),this.pageOptWrap.append(BCGrid.getLangText(t.lang,"Records")),$("select",this.pageOptWrap).on("change",function(){t.pageSize=$(this).val(),t.currentPage=1,e.render(),e.goPage()})}},_getPageTools:function(){var a=this,e=this.options;a.toolButtons=[],$.each(e.buttons,function(e,t){a._addToolsButtonItem(t)})},_addToolsButtonItem:function(e){},_bindEvent:function(){var t=this,a=this.options;t.pageLinkWrap.on("click","a",function(e){if($(this).hasClass(a.disabledCssClass)||$(this).hasClass(a.itemCurrCssClass))return!1;$(this).hasClass(a.firstCssClass)?a.currentPage=1:$(this).hasClass(a.prevCssClass)?a.currentPage=Math.max(1,a.currentPage-1):$(this).hasClass(a.nextCssClass)?a.currentPage=Math.min(t.pageCount,a.currentPage+1):$(this).hasClass(a.lastCssClass)?a.currentPage=t.pageCount:$(this).data("page")&&(a.currentPage=parseInt($(this).data("page"))),t.goPage()})},goPage:function(e){var t=this,a=this.options;a.currentPage=e||a.currentPage,a.currentPage=Math.max(1,a.currentPage),a.currentPage=Math.min(a.currentPage,t.pageCount),t._getPageInfo(),t._getPageContent(),a.showPageSizeOpt&&t._getPageOpt(),BCGrid.isFunction(a.turnPageEvent)&&a.turnPageEvent.call(t,a.currentPage,a.pageSize)},addToolButton:function(e){}},BCGrid});